import lzma
import os
import struct
import sys

from dataclasses import dataclass

if len(sys.argv) != 2:
    print("usage: python unpack_mang.py [MangData_pak file]")
    sys.exit(1)

# XOR mask for "decryption"
XOR_MASK = [
    0x4FC7F8A0,    0x818E3AB7,    0xA089B103,    0xAE8ED5EA,
    0x56BF130D,    0x50130D06,    0x3A436883,    0x548E7A94,
    0x4AA66C4B,    0x10C0239C,    0xFA158429,     0x949EFC3,
    0x93917ADD,    0xD707BC50,    0x917BD784,    0x94C8ED78,
    0x1EE7BF47,    0xD24D1FF8,    0x96CDEAE7,    0x37965801,
    0xA3F82090,    0x10865FF7,    0xDA544DFA,    0x83D08B7F,
    0xFD85AA62,    0x52BCB6D3,    0x38D165C8,    0xA233AFFA,
    0x78D7EC8D,    0x61A44E3F,    0xDC97BD4E,    0xAC2F8677,
    0x20CC461F,    0x582A14AA,    0xA414D88C,    0x75713AF9,
    0xEE6306F,    0xF70608D9,    0x61E1FE95,    0x5DFD34A3,
    0x3FDE1432,    0xF3478AEC,    0x2ADA0E23,    0x2136E23A,
    0xDE329906,    0x45662E74,    0xB4A44A1E,    0x28ED903B,
    0x19327705,    0xF8578AFE,    0x97C1AF35,    0xD879B3EC,
    0xEB18BFD5,    0xFF1486AB,    0xA8243FE7,    0xE3C03BE9,
    0x72113636,    0xFD33ADB8,    0x4137501C,    0x16C9DFB6,
    0xB9CE1B15,    0x1FF07B11,    0x93F7DF27,    0xA9CE75CD,
    0x8F987D96,    0x5F47AFE4,    0xFDFDE1E5,    0x94C83AB1,
    0x52DB892F,    0xE1F31BAC,    0xCF8E12C4,    0xD783A77A,
    0xBDBA5BAA,    0x3B9270C4,    0x28AD3FD6,    0x532B3EE9,
    0xC09B4C44,    0xC7A616F6,    0xB9A9A0DD,    0x90DD5BF6,
    0x493CC42E,    0x742B740D,    0x22AEA263,    0x173A06E0,
    0x16BE0928,    0x96A643DE,    0x345AB942,    0x3AEFC03E,
    0x85B9100D,    0xB338E1E3,    0x4E43AEB8,    0x6852550C,
    0x6748C9E1,    0x57A71D44,    0x248C70F6,    0x7E632ABE,
    0x499D7768,    0xE1F586E6,    0x93FA6632,    0x14E60FD2,
    0xCC907AAC,    0xD7EEBFFF,    0xF2FCBB33,    0x4C710E5C,
    0xEFAB1D97,    0x30B550A5,    0xDEBE32E4,    0xA87B3C94,
    0xE2C16C79,    0xA8D7EE5B,     0xE3A73E4,    0xD56A08ED,
    0xD67982A2,    0x115BD5A3,    0x1F47DE16,    0xFBA98A20,
    0x4B5D576A,    0x1FCE1092,    0xE7AAD82D,    0x90B1573E,
    0xE16F1047,    0x3B5DCB59,    0x48A59C41,    0xA51ECA3C,
    0xA9B6D157,    0xD358AB59,    0x76070C5E,    0x373DDD8B,
    0xF5CD1077,    0xA94B11B3,    0x513BFF94,    0x801C7121,
    0x2875DB4C,    0xA4897155,    0x325C9582,    0xC61A238A,
    0xFF2433D8,    0x9CC22410,    0x373F8171,    0xADF6187C,
    0x70955488,    0x328CB2A1,    0x9989DDD6,     0x366D161,
    0x6C598B44,    0x96F82946,    0xF83CFCEE,    0x91197A6E,
    0x36E582FE,    0xE12065CA,    0xAD46B4C9,    0xF055B8AB,
    0xAF271248,    0xDE35E79A,    0x999133D8,    0x547F7B0C,
    0xAC8B8F58,    0xDD9623D2,    0xF4194C01,    0xDA2FCA76,
    0x401AA0A4,    0x8056CBCB,    0x22F1492C,    0x61BB9DDD,
    0x8D7D88EE,    0x91D4A9AF,    0x79DF3A55,    0x50CE2047,
    0x9716F6D0,    0x4A4A6588,    0x9C63461C,    0x6AF20BE2,
    0x13085ED2,    0x2ED65B4D,    0xC64BF953,    0xA1A27194,
    0x354FB976,    0x509568F5,    0x99C0968F,    0x61DC118A,
    0x14BE548,    0x2BAABD87,    0xEF5EE83B,    0xE4AE1FC8,
    0x9BCF6E70,    0xE9D12DA9,    0xAC3A0DA0,    0x80C81F3A,
    0x1A39DAC4,    0xBEF1FA32,    0x8B754A01,    0x758A2C43,
    0x51F58253,    0xB0AAAEB3,    0x6D50DA1D,    0x42174B4B,
    0xA61CD9F5,    0x68E3E091,    0xB0B9C34E,    0x71613ED5,
    0xE0734363,     0x5DF8D10,    0xF7DB9A89,    0x68BDCE8A,
    0x758DE2BA,    0x684A62E0,    0x7F2E607D,    0x3AF1A149,
    0x59CCE519,     0x9C50EB4,    0x6B06481A,    0x76C586B8,
    0x547EDBA6,    0xC20293CC,    0x97270EA1,    0xF69045D6,
    0xCD5E0124,    0x24C5170A,    0xEACFC2BA,    0xB34B718B,
    0x1B310F01,    0x427FAE79,    0x214D1FFE,    0x11A2B9B0,
    0xD3538F64,    0x835A356A,    0x9F89500A,    0xAD01B62B,
    0x1F402944,    0xF3C7937B,    0xC31CCB0D,    0xB6A4B8F5,
    0x62EF170,    0x14159728,    0x335B19D9,    0x33AB1E35,
    0xBF15BCA2,    0x28F5425C,    0x2DE6AB78,    0x59269C40,
    0x4C5EA11,     0x9999385,    0xD7BFA8B0,    0xD9A415B9,
    0x5C713DFC,    0x7337601C,    0x10D03EA1,    0xB04AE299,
    0x70C122C3,    0x5A2120BA,    0x3F84EF49,    0x78D92CBF,
    0x5967066C,    0xB14F392B,    0xA1D2679D,    0x3648AF82,
    0xF023A23B,    0x437658F4,    0x21CD4392,    0xABCB98BE,
    0x20DD523C,    0x7D133A6F,    0x1BB8EB35,    0xA7EAC9EB,
    0xB0B85C5A,    0x42FA7DD1,    0xB9135B2F,    0xD40FB2A4,
    0x1D93466B,    0xB8EDF343,    0x3BA5F5E3,     0x8919BBD,
    0x5F29223D,    0x9A23F2E8,    0x491DD375,    0x16CDF7D1,
    0xC01665AD,    0x885D9E75,    0x428C155A,    0x9CAFB352,
    0x2E6F2DB1,    0xD4F6C03F,    0x128AAE6F,    0xD8C5881B,
    0x80CA186B,    0xD67492C7,    0xF6383B7E,    0xEF4D467A,
    0xD3D616B7,    0x39911352,    0xDBD0CD5B,    0x48C72A49,
    0x53E7AEBE,    0x4FD74EEF,    0xA2C23E68,    0xD0052A77,
    0x8B045D05,    0x5AA5B891,    0x74347B2C,    0xD4B7461B,
    0xB7F9D8F7,    0xE3437318,    0x139D59E2,    0x5085D802,
    0x94EA6782,    0x89F4A6E1,    0x2851E389,    0xB412E7BF,
    0xADDF2C1A,    0xC98449DD,    0x980FAA70,    0x4493F142,
    0xAFD57ACF,    0xDC597499,    0x4E9596CC,    0x5D61C0DC,
    0xB94F22DD,    0xFAFEB653,    0x8B2EB444,    0xC805395A,
    0xA5E2C23D,    0xB1BEDD06,    0xBB438904,     0xCC7278C,
    0x63CD18AD,    0xB3A7CB7F,    0x42E95DC8,    0xB9C593DC,
    0xBF034E4F,    0x2624C368,    0xCCF213F2,    0xC07A125A,
    0x39B84F2A,    0xF489B9DA,    0x1E01F097,    0xBB548E4E,
    0x4D7C92C1,    0x1DA02872,    0x610FF18F,    0x40429FC7,
    0x4BBFECA5,    0x8341D7D4,    0xFD889A83,    0xB1C5572C,
    0x21E96580,    0xBE5A34CC,    0xDDD4C484,    0x917E904A,
    0xAD667C28,    0x69039DCE,    0xC769EE11,    0x493F40E4,
    0x1137022D,    0x748D3493,    0xA858902F,     0x29D484A,
    0xF903E76C,    0x74942B1F,    0x6661E378,    0x6E7D42DB,
    0xF8A7891D,    0x6F8B17D7,    0x2E80BC24,    0xA0A6D1A4,
    0x4C4403E3,    0xB350C00F,    0xC5FF5425,    0x53CF76E6,
    0xB5CFFD5B,    0x22B8711C,    0x5D8797A9,    0x42B2D8AB,
    0x45A70330,    0x7D23C5DD,    0x5AAA7DB7,    0x70191DD1,
    0xAA1B4724,    0xC28B7BD8,    0xAAFB5038,    0x7EEE2F22,
    0x8802FFA9,    0xEB1243BC,    0x961A8386,    0xFBD0975C,
    0xBFC530E9,    0xCC920FF9,     0xEC1FB80,    0xB21C4844,
    0xC07AF85C,    0x5BB06651,    0xF55B6A19,    0xF6016E37,
    0x5EE3E851,    0xFF6CAEE0,     0x28E12E3,    0x7E90BE3C,
    0x998CCD86,    0x6BAA8237,    0x76CE1F2B,    0xA34A4B0D,
    0xF4588434,    0xDF4EFCE0,     0x66DF0F8,    0x4534CD2C,
    0x430AC59C,    0x833E0DFA,    0x19A8EE2D,    0x87DF7D75,
    0x775EFA1F,    0x327F42C0,    0x9E3C560B,    0xAE85D729,
    0x731409C6,    0x4BBD9F9E,    0x62720BC5,    0x6C09F701,
    0xDB8226D5,    0x83DDE93E,    0x54306797,    0x291461BB,
    0xE12425DD,    0x328E7898,    0xDD898BCC,    0xDFA052B2,
    0x1C2946CB,    0x22D70408,    0x31CEAED2,    0x63089262,
    0xCB858B75,    0xE52BF853,    0x989DEACC,    0x3596C501,
    0xB685802B,    0xA1F2C443,    0x45F195A0,    0x5218B88C,
    0x7258914D,    0x5EA3A7AC,    0xA3348608,     0x3ECB258,
    0xB0A2D8D2,    0x59C78386,    0xA4496D9D,    0x2C934520,
    0x980F705F,    0xD397AD76,    0x15252172,    0x223C1C16,
    0x8DDDBD52,    0xE381BD5F,    0x66D76C19,    0xEFD94CF4,
    0x87F246D5,    0xC33FDAF5,     0x69D61B5,    0x31AE270E,
    0x5BE97C6F,    0x20E111CD,    0xA7F2A912,    0xDBDF8759,
    0xD209391,    0x6D641EE7,    0x161FD12C,    0x92052187,
    0xA5CAC9A5,    0xB2BA4245,     0x6C72042,    0x73B1D20E,
    0x79043EA3,    0xD8640F76,    0xE4FDE0E8,    0x6C90F73D,
    0xFF5B3D20,    0x80773A2D,    0x2653B213,     0x2EAB048,
    0xA0E48F56,    0x4DB268C6,    0x1863DF2E,    0x28B9BC5D,
    0x24ACF41,    0x379183E1,    0xAF68A4A3,    0x8F3CC4B0,
    0xDBD936A4,    0x5955066D,    0x5A4B06F5,    0xF47D298C,
    0x4618649F,    0x441B4FB4,    0x4EAE9EC5,    0xEFEBD7E3,
    0x884D413D,    0x4C66EBF3,    0x59866EEB,    0xC4E717E0,
    0xE9993C83,    0xDAB6EFE7,    0x31A0ACFF,    0x34D2D7F3,
    0x85802783,    0xBB143F5A,    0xC53A16F0,    0x4D9D0565,
    0x117B7FE9,    0x729EDEB4,    0x8C0CBE0E,    0xB75ED365,
    0xB707420F,     0x3A04810,    0x555F601A,    0x88D61698,
    0x61B8B885,    0x479D37C5,    0x9716AADB,    0x140F82B0,
    0x88C8CDAC,    0x3D62F6FD,    0x4342132F,    0x365D116F,
    0x86A558BB,    0xD694383D,    0x8E33270F,    0xA9FA3DC2,
    0x6581ED59,    0x4BC3DC7B,    0xCA8359AC,    0xD512E0CE,
    0x2EE53126,    0xE4F747AE,    0x31AED17B,    0x9DCCFE7E,
    0xBDBFA64C,    0x53432F58,    0xB09940C3,    0xB0E69493,
    0xCF2FB12,    0x79506B9F,    0x4228AA2E,    0x583EE937,
    0x8668DF69,    0xBD734856,    0x38CA3CD7,    0x4E635F8A,
    0x561DD1FF,    0xDDB8D00F,    0x8A909663,     0x5A342B6,
    0x3833E94E,    0xB9F8262B,    0xAAB5A283,    0x7DA29779,
    0x4784B2A7,    0x23E2476B,    0x54B1DD8E,    0x14E1F0B8,
    0xCF2C744A,    0xB40F6A01,    0x57CA2D90,    0x51D43915,
    0x1E9E0471,    0x9B12C21A,    0xEFA3AB57,    0xB9F08470,
    0x4DB215E0,    0xE685DA75,    0x104D7B02,    0x9F3C6189,
    0x9C368A79,    0xDD9EDAF0,    0x31569296,    0x6E5E2B02,
    0x36F945C8,    0xC8BB619A,    0xA8D80F0B,    0x81315575,
    0x8A68F393,    0xC575CCBD,    0xEF8C845B,    0x6ECC3C84,
    0x938B626E,    0x18AA8C77,    0xFB574E15,    0xD61EF86B,
    0x31264D45,    0x739576C0,     0x8DB5C68,    0x3970AE08,
    0xF0412E70,    0x535B8E84,    0x678B84BB,    0xBF82D9F3,
    0xE0B78CC5,    0xC7955C2C,    0xD7B1D4B4,    0x9213218C,
    0x5FCB4DA3,    0xC26BBBB0,    0xCC09DE4F,    0x24712509,
    0x6B348784,    0xEB9BA7AA,    0xC34A0E69,    0x8390D385,
    0x732F4B0E,    0xED0E8EDE,    0x913AF1D4,    0x2D932F19,
    0xA70BF922,    0x4964A2D5,    0x33390EE6,    0xD8DC2ADD,
    0xC542126D,    0xA28926E3,    0x9F593185,    0xC9226E08,
    0xEEFD0275,    0x90C0BEBE,    0x13E53CBC,    0x217AAFF1,
    0xF231752E,    0x7138C389,    0xE4F8784D,    0x2C6DFC2D,
    0xA1A2A586,    0xB3150E68,    0xD18A65B5,    0xB1048F93,
    0x1C7DAAF5,    0x2F08CB0F,    0x527E07CB,    0x49D89A54,
    0xA262CA13,    0x6BD84A4D,    0x6335B9C8,    0x23261B86,
    0xE5784A1D,    0xF6FA4A25,    0x5D21FD57,    0x5CDA2AB9,
    0xD67ABC0D,    0xB1194ED6,    0xBF4BCC26,    0xCEA3C704,
    0x78C9D22C,    0x24A7EBF2,    0x816D6477,    0xE2FFB192,
    0xAA7D2B9A,    0xC5759AE6,    0xE1FF98AF,    0x58502DB8,
    0x1EF2565,    0x57B88212,    0x3946A468,    0x9FE6DC05,
    0xC512A14,    0x2B235150,    0x49E0F7FC,    0x229589C7,
    0x2F3905BB,    0x776C0590,     0xA5E0C9B,    0x1842F92C,
    0xECAFAF88,    0x2868BCDB,    0x7B4BAC56,    0xD4713D44,
    0xB8481F55,    0xAC948CEF,    0x763FCEB4,    0x17DAFC18,
    0x44261838,    0x49244845,    0xFCF15B3C,    0x5BF4CD38,
    0x55167E0F,    0x651757A6,     0x9C5028C,    0xA90BFBCA,
    0x8D162218,    0x5CC403BC,    0xDB5D0AE1,    0xE7C56220,
    0xC26E15F7,    0x50EEC61F,    0x5023212F,    0xA441B2BB,
    0xC7B6F2D2,    0x754F2165,    0xA7E5282B,    0xEC1B496C,
    0xC0EFB854,    0x64AB62B6,    0x5D5C895E,    0x9A817ED4,
    0x73108FC5,    0xEB5C7B58,    0x73BB8334,    0x2344F382,
    0x9490221B,    0xDAEBD1C0,    0x45C7FD8D,    0xE7E36476,
    0x99016582,    0xD9180CA1,    0xD6E1D2CC,     0x7A275BC,
    0x716EEF6,    0x31E96380,    0xA295A466,    0xAA138874,
    0xC33AC14E,    0x1EC2F341,    0xECAE2C74,    0x58AA88E6,
    0xE31DA048,    0xA5ED0AB2,    0x924488C4,    0xC34EB813,
    0x7F43D923,    0x5E2F76A9,    0xD64C8DE3,    0x1CE588C1,
    0xFC959C23,    0x41D5DB85,    0xB6291738,    0xDAE8E10F,
    0x617445AC,    0x7E48FCC4,    0x37B95706,    0x19F0F782,
    0x25C3AC4E,    0x4B159118,    0xB46CA306,    0xD9C91898,
    0x7FFBFDCF,    0x2D0891EE,    0xB5CA4CF6,    0xDCFDFAD2,
    0x373E7E45,    0xD0B10A83,    0xB60D65A7,    0x6E6C91CF,
    0x74DBE21F,    0xD6FFE575,    0x7EA5970B,    0x3652D9D0,
    0xEF0A138,    0x23C546D0,    0x6AD874C8,    0x8960A9CD,
    0x5EE9B9E5,    0xAED2CC1F,    0xC04543C8,    0x3AC6810A,
    0x8B1C0D0A,    0xD6FFECFC,    0x80F6D149,    0x63C8DE1D,
    0x60CF29A0,    0x2D3BBDA3,    0x307841EA,    0x40490407,
    0x14539A53,    0x472148FA,    0xAEDEDC3F,    0xF55D54BD,
    0xA08A3B02,    0x8D04552D,    0x84E0E4DE,    0x655A95BE,
    0x8FFE855D,     0xF8044B1,    0xB05EDEF1,    0xFDE75021,
    0xCAECE06E,    0xCD8DD3DD,    0x7976E6C7,     0xA0F8F9F,
    0xEA59F1A9,    0x1009F4F8,    0x4295FF5E,    0xFE49BEAE,
    0x8C9C6DFF,    0x314C9C48,    0x4F83647B,    0xD091ED88,
    0x9874E3EA,    0x70B88FA0,    0xA478D0B5,    0xBDF3AD41,
    0x19131703,    0x40493675,    0xC8A75C06,    0x229E5351,
    0xAB1C489,    0x97A16DE9,    0x9E51425B,    0xC5EFD0A8,
    0x279E79FA,    0x449E4F61,    0x2ED334A4,    0xAC0882C0,
    0xBACAE020,    0xB5E80D0C,    0xF83C2BE7,    0x6558FDA7,
    0xF05F941C,    0x4E7F37FA,    0xC951B34A,    0xDC32E415,
    0xA54AEB7E,    0x384A902E,    0x822AC5A7,    0xADDA32F4,
    0xB4CDCC50,    0x302E60A6,    0x6DB8091E,    0xE99709FE,
    0xCB11F9A8,    0x5615BC72,    0x8CDF2F1D,    0xF3BD89BC,
    0x373167B5,     0x103E23D,    0x6AF9C179,    0xCA449DA2,
    0xB2D08454,    0x89287CE6,    0xEB756C7A,    0x5555499C,
    0x3D29919C,    0x9C6BFA8A,    0x9AD7D46B,    0xBAD9791B,
    0x62946970,    0x8E7C5E94,    0xFAD7E32A,    0xAC8E56A7,
    0x1125D80B,    0xA26609CE,    0xD8E89837,    0x3B8E93F3,
    0xE6356998,    0xE49C9273,    0x17495DC7,    0x9F67BDE5,
    0x82EDB2BB,    0xF489913C,     0x4174B52,    0x10A90BAD,
    0xD1632BA3,    0x54A46F72,    0x225D88A3,    0x10752CD1,
    0x631B759A,    0x3BFBBAFC,    0x7FA28CE7,    0x410B1E3F,
    0x37A23696,    0xE44870F3,    0x81FCF7C1,    0xACDD76D9,
    0xB9BDC49,    0x607AD12D,    0xB51EE056,    0x1A22B410,
    0x304C782E,    0x63CD314D,    0x9F64235C,    0x605C13E2,
    0x54B0079E,    0x1455C55A,    0x8E6E30AF,    0x2D74557D,
    0xD88A45DA,    0x610F75C8,    0x6926E15E,    0xDD411CC1,
    0x1D7079A1,    0x49712B0B,    0xFCD046BA,    0xCC1C2E58,
    0x525DCE3E,    0xB2FAA225,    0x502574E8,    0x1CEED0C2,
    0xC8C41A93,    0x37453937,    0xF253D5F1,    0x90C510E6,
    0xC119B0B0,    0xF3134113,    0xCA9A7D51,    0xD5DC1324,
    0x3DE93562,    0xD85FCCC8,    0xE7577205,    0x5632EE60,
    0xCE65E83E,    0xFD6D0139,    0xD114811F,    0x87956C99,
    0xE5737936,    0x6DDD6522,    0xD71513D4,    0xBC3864F3,
    0xA53E5726,    0x75B53332,    0x63F06D0F,    0x7439864A,
    0x3046FB66,    0x78F6A695,    0x43179479,    0x2A3FAD41,
    0xF872C0DA,    0xBD29CD8A,    0x80E78E12,    0x237C2F51,
    0x101D3102,    0x4070D86C,    0xACBC38BA,    0xC3C5AADC,
    0x7B27D006,    0x7F9A6A46,    0x30FF17CB,    0xDBA25A3D,
    0x7C85F54A,    0xD02AE762,    0x9BB7221B,    0x775CE050,
    0x67D29381,    0xA9EE4759,    0x7A171C15,    0xAE0B9E90,
    0xEE5F0AB4,    0x7811E226,    0x9D8E5BC9,    0x75297A99,
    0x7841FADC,    0x6CA1C5AF,    0xED5D9AFA,    0xECA3B7C2,
    0x6662916B,    0xCA2C7E5D,    0xBF9C4E2F,    0x31E442A8,
    0x6E93DBDB,    0xBC426C26,    0x1D576FBD,    0x2D6E82BF,
    0x659912C9,    0x2091929F,    0x1891CD65,    0x63DDA962,
    0x103D6FF6,    0x54EFE48F,    0x9B5F5DD1,    0xC8838365,
    0xF25EF863,    0x91ED9AF8,    0xBCEE0CB9,     0x973C6A0,
    0xA484D3D8,    0xAF637CB0,     0x5200B60,    0xDD0F6207,
    0x99E613FD,    0x7E03B669,    0xC88CA3B0,    0x601CD030,
    0xF8860A61,    0x90E62744,    0x759B8245,    0xD0CFE86C,
    0xE7B79690,    0x8CA22C64,    0x5D938E7E,    0xED60A651,
    0x5D3377A3,    0xFBD67879,    0x8FA6B211,    0x459705CF,
    0x71A8194B,    0x1F386052,    0x9E052F90,    0x7B5FC7BA,
    0x28CD6567,    0xBAA6AAEF,    0xF76AEC87,    0xA5504BDF,
    0x4BE9178E,    0x65BD6190,    0x32314903,    0x13C75993,
    0xB06D03A7,    0xD95D9DBF,    0xD9E16823,    0x21737241,
    0x10FBEDF0,    0x4AC35DEC,    0x45C085A9,     0x6E02379,
    0xD27F5E95,    0x2C9451F2,    0xE1DE408E,    0xA990D408,
    0xE0B5E3BA,     0x56EA9AC,    0x862D6F8A,    0xE803947E,
    0xF0C26F92,    0xC37A6B85,    0xC107F02B,    0xF44AEF43,
    0xDCBE9EE9,     0xA77BD08,    0x2AC678E0,    0x141CBCA5,
    0xEDCA0F37,    0xFCD0376B,    0xAFD1DE0E,    0x7C5A696E,
    0x2E182A2F,    0x1529342A,    0x68AEF31A,    0x222C51EA,
    0x35FFFACF,    0x726E220A,    0x648D4E7E,     0x10A07FE,
    0xFB907571,    0xA665CEB3,    0xFBDC1B59,    0x73C9AA38,
    0xAF9D52DA,    0x87BD3DBB,    0x9ED96C79,     0x138B35A,
    0x784FD4C9,    0x7F207138,    0x249B0A74,    0x2D1F4670,
    0x50349D8B,    0xDF3DBF4E,    0x9E2B45B0,    0x4659FEDC,
    0x544E7E06,    0xA9E0A2C0,    0xA58A41F6,    0x37E544E7,
    0x8CA645CA,    0xE3FE8203,    0x2BCACB07,    0xD8741A53,
    0x45DA0E27,    0xEC440F48,    0xC71B261F,    0xBDF2EA67,
    0xDA2D9433,    0x43A88491,     0xDD5D615,    0x8624DC83,
    0x9960362,    0xDB7B863F,    0x5694FEDE,    0xB0AA21AD,
    0x39D3BF14,    0x6DF466A1,    0x93BC2129,    0xE21942A3,
    0xDAF6C1A1,    0x4749FC09,    0xA091F85E,    0xC30575E9,
    0xA8F95B70,    0x97B3EF54,     0xFC4C841,    0xC315E9DC,
    0xFE471003,    0xC6070AFE,    0xF98126F5,    0xEF109842,
    0xAC536002,    0xBB4309B8,    0x55054F94,    0xC2EF15D0,
    0xBC241BD6,    0xB521E96C,    0x3BA67835,    0xF16D5ECD,
    0xCD67AC32,    0x161EBFD6,    0x40EC1C09,    0x3E952C91,
    0xDE7F71A3,    0x34167D12,    0xBF984A5F,    0x48D2411C,
    0x1B1301A2,    0xA8CCC6A7,    0x2D3B793D,    0x5884B825,
    0x329F8523,    0x24FC46A1,    0xE54057E9,    0x3709DC2C,
    0xA18504A3,    0x38ECF419,    0xFD841580,    0x77CF6B08,
    0xA1D30C0,    0x2D7BED45,    0x13DEBEFE,    0xC7EBF1F4,
    0x79423DC0,    0xCDB1C18E,    0x193383D7,    0xC4201629,
    0xBDE62CA1,    0xB9CFC099,    0x2D8507FE,    0xC66FE65E,
    0xB7221BB1,    0xB5E0CDDC,    0x6683B7FB,    0x302FAFE9,
    0x283E1918,    0xF949AC2C,    0x211B97FA,    0xC296C345,
    0x7CCEEF68,    0x8355D7CD,    0x54858E59,    0xEACC52A2,
    0xA6B9792F,    0x604CC703,    0x5E5ABC39,    0x11FBB57B,
    0xE6C96F87,     0x97DC8A0,    0xD49E468F,    0xEADC3E9E,
    0x9D413624,    0x25D04996,    0x585327B4,    0xC84B8C45,
    0x9A66B466,    0xE25AA906,    0xDD878074,    0x6A55D59C,
    0x71941AE8,    0xC2648B50,     0x6E6EA9C,    0x4748BE5B,
    0xC14CBA12,    0x6B03A625,    0x68CC4410,    0x6743204F,
    0xFC455A2,    0xF7A59092,    0x644E80D2,    0x2C46E36B,
    0x89F7E548,    0xC5A19396,    0xF2CEFB9E,    0x2544C7DD,
    0x6337792A,    0x48C97B30,    0xF211C4EE,    0x5B2FB917,
    0xA038F87C,    0x5675666A,    0xFDC37491,    0x288C9CE2,
    0x62267E8D,    0x7A181472,    0xB41178B9,    0xFD80A072,
    0x3DB01F57,    0x45CFB722,    0x1033620C,    0xBB63106E,
    0x39EC00F,    0x9AEE4614,    0xB17F3EB2,    0x7E4B9D07,
    0x965A6534,     0x116C632,    0xB2F9DA67,    0xECA33982,
    0xBD047FA3,    0xF6BC2245,    0xF4E29F8B,    0x8E35D9D0,
    0xEA803D23,    0x3BC37406,    0x73C959B0,    0x8F3CD396,
    0x938ADCF3,    0x23875BAA,     0xF18892C,    0xA0762342,
    0x7AC2FAE5,    0x6768C6FA,    0xE2A5BAA6,    0x39313F96,
    0x85BC615F,    0x7665C9DB,    0x924B4B2E,    0xEE5D6840,
    0x89145975,    0x4023E7E2,    0x18E84240,    0x431A7C60,
    0x1B7878F5,    0x8B036A65,    0x187F9ADF,    0x74CAC022,
    0xDF3EF47C,    0x41AC2785,    0x2DBD9624,    0x4CA134C6,
    0x5EEEF17D,    0x4122DA47,    0xBB8D0E45,    0x713462B6,
    0x4B5BCFDB,    0x2DCE731B,    0x3EA641AF,    0xB6873012,
    0xDE26FE70,    0xBC95E0F3,    0x9B1F2493,    0xEA23ACBF,
    0x1D5B4EA4,     0x9E6E4D2,    0xED77B1F2,    0x289E607C,
    0x2E78B97B,    0x62C764D5,    0xDB323CB4,    0xA7B39FEE,
    0xA802BAA0,    0x1DE7354D,    0x625ABA32,     0xBCD57B4,
    0xE3139CFF,    0xDFB2EFC7,    0xA41A9A48,    0xB418DE70,
    0x4768C3CB,    0xF558C0A1,    0xC3C99067,     0xE904B5E,
    0x9A778614,    0xA167B519,    0x227EE6A1,    0xE195B5DF,
    0xD57877D2,    0x67528B5A,    0xBF19CEBD,    0xA2F69690,
    0x707C3AFF,    0xDD09860F,    0x82D82FC6,    0x43858F4F,
    0x3474CE9B,     0x384BA73,    0x89EA7516,    0x7F24BAD5,
    0x88C9E0C3,    0x89D2DCE0,    0x7A78E2EF,    0x3155FDC2,
    0xC66D203E,    0xA5AF9661,    0xD539E385,    0x1E4F58AC,
    0x8860058E,    0xDF0ED3BB,    0x42FFD60F,    0xC78635B3,
    0x77CB2B03,    0x682B8F88,    0x5ECFE254,    0x3D42370A,
    0x9C8F17C6,    0x629C2ABE,    0x93E74444,    0xE7AC0E0E,
    0xB2CC0F6C,    0xB0E1B6C3,    0xE0519BFD,    0x5EDDC153,
    0xF27DE806,    0x5072467D,    0xAEF74566,    0xB47286B4,
    0xE77ED3AD,    0x215141E0,    0x9EB01DB4,    0x481587E4,
    0xBDA4B199,    0x34182E01,    0x59505B81,    0x95153EFB,
    0xDC661AC,    0xA20C09A1,    0x5E385ADB,     0x56FBB8C,
    0xB2D10E83,    0xD7A80E45,    0x58E46BD2,    0xB9E57BAC,
    0x1A5B8586,    0xE3370DBB,    0xE883280C,    0x6308B38D,
    0x8EA8FDF8,    0x4BD6B539,    0x787A3E4E,    0x8D49A504,
    0xCC8EF89,    0x558EED5A,    0x8B824292,    0xF38D6B1E,
    0xF9CE2E3,    0x60E39941,     0xA2E7E97,    0x483A4AB2,
    0xE3EDB83B,    0xAB61729A,    0x187CC56F,     0xDC482EB,
    0x76F80560,    0x2E2A5136,    0xE0ECBD8B,    0xE0449B5D,
    0xA58058D0,    0xE00E848F,    0xE409B6D6,    0x4A03B913,
    0xC5B11C1,    0x119599E3,    0x53F9F039,    0x1289EB9E,
    0xD807ABB6,    0x310F31BE,    0xCB14F931,     0x9B47A28,
    0x1A35950D,    0x2825D009,    0xBCEA7060,    0x5E3FB602,
    0x8C5D758C,    0x9E6CAC21,    0x295FDA1C,    0x6BD74DB2,
    0x6FCB047A,    0x556F7BDB,    0x7EAD767A,     0x92E9609,
    0x5033D826,    0x6EC44925,    0xDFFF0767,    0xD782632C,
    0xDEBAB679,    0x419A4203,    0x7BFDA530,    0x99354E28,
    0xB80DE08A,    0xA84A832E,    0x55DC1217,    0x78D80E84,
    0xBE6DE72A,    0x55646F9B,    0x1BEF8261,    0x5C43C14A,
    0x5EC1F9F5,    0x9AC3F811,    0x7235F165,    0x3B18C39E,
    0xE8A7B6E3,    0x421C7533,    0x496AF31F,    0x635F7A4B,
    0xDE7E77D6,    0xD70B6B97,    0x2518803D,    0x510FA1D0,
    0xBEFDA62E,    0x7AA6E450,    0x75A74731,    0x7F2224FA,
    0x58410C51,    0x310FBF01,    0x5F6BFC40,    0x32A1E468,
    0x1FD99EC6,    0x357BF8E9,    0x9336AC91,    0xCB391120,
    0xF25E53BD,    0x44D0017E,    0x97678841,    0x98C5F0A1,
    0x74FAEB20,    0x6EA88BEC,    0x9AFAB8ED,    0x23E4B5F2,
    0x547E49A5,    0xEA67DC36,    0xC5982B4A,     0x1074C31,
    0xA5F03C5F,    0x64CC1D38,     0x7A963AB,    0x257CAA21,
    0x2B1CD04A,    0x487D2441,    0x68E04D97,    0xAE86223D,
    0x25A2235E,    0x1A1CD020,    0xD84F89DD,    0x37672E4A,
    0x27092D9F,    0xC0D0CEAF,     0x1F23F1A,    0x27F44162,
    0x634A18AA,    0x57DEEF6D,    0x92C96BD0,    0x81A39E85,
    0xFC66894A,    0xFC347502,    0x165933F5,    0xB4991E2D,
    0x56F3F604,    0xA673655B,    0x3DCAAE03,    0x6E4282D9,
    0xE4AD7329,    0xEA8C56AF,    0xB0703E03,    0xE6524C22,
    0x7B04FF63,    0x5747C199,    0x62DBD826,    0xB0E78246,
    0x9CAA5BC9,    0x3C55D221,    0xDD69DACE,    0x8D8D0939,
    0x4EAD54EE,    0x7D6138CC,    0x93555822,    0xB9CEECB9,
    0xE3FC1770,    0x649D72B4,    0x2F486999,    0x3FCCB3DB,
    0xD2FB7C86,    0x6FD7228D,    0x6367FD90,    0xC3C4AF1A,
    0xFF175F94,    0x1E05DCBC,    0x3C65AA57,    0xD8A84D69,
    0x904DE43A,    0x48D67967,    0x6A147CBF,    0xCA2A62C1,
    0xB9425261,    0x65C4E0FF,    0x9B6E46B0,    0x744C7EB4,
    0x9152DBCF,    0x66215E59,    0x44B16E33,     0xE743CFB,
    0x5D1B7136,    0x7C267037,    0x6E64C403,    0x77779005,
    0x649014C0,    0x6E081659,     0xFEC4EA0,    0x112C1B0A,
    0x3B0FA1A7,    0x68062290,    0xD29B95DD,     0x7FBF316,
    0x1A63A6BB,    0x477608CD,    0x6F427C72,    0x9D70FE22,
    0x2862AD7C,    0xF058AEAF,    0xF13D8B07,     0xC433B97,
    0xCBF60E22,    0x9C663F93,    0x8E063F48,    0xBF700EEB,
    0x7DAEC030,    0x24A275A8,    0xF2C5DB75,    0x36469B29,
    0x934E2A87,    0xDAE9ECFA,    0x15DE3D72,    0x46F29084,
    0x96DDEC72,    0xD47F7606,     0x4852356,    0x76167265,
    0x8F3DBD37,    0xB82364C6,    0xB54783FA,    0xC650F27D,
    0x55B0A927,    0x949D59C6,    0x57A1DC8B,     0x5543D55,
    0x6270EF2E,    0xAA4D9C30,    0x220D8298,    0x99F6475C,
    0x1E3A4DE4,    0xBFBD675C,    0xA213EDA6,    0x59BA1F79,
    0xB2634D9E,    0xEC3233E2,    0x91558EBC,    0xD8E64199,
    0x59639778,    0x71378D2C,    0x9EA61BF2,    0xB3135FC3,
    0xAB69446D,    0x7F33E6FE,    0x41946008,    0xE5B53AA2,
    0xF3672860,    0x8CF45F11,     0xAFB10EC,    0x95BB689A,
    0xFA27A8B3,    0xA3C41C18,    0xF01793D2,    0x650EAED7,
    0x5DD40650,    0xB47491D8,    0x258A5A42,    0x4529495A,
    0x5495B13F,    0xE1EE59B6,    0xE27AA8A5,    0x3FAB400E,
    0xC111AB0,    0xD348FE45,    0x3718EC5A,    0x4CE2B5D1,
    0x6E05FA12,     0x5CCCCD5,    0x5EB10640,    0x1FDEB38E,
    0x7753B11C,    0x9695A40C,     0xA439C4C,    0xF8820343,
    0x3160561,    0x1D1145E7,    0x3205F095,    0xF5107217,
    0x1DA77CE1,    0x6F97A458,    0x697C2665,    0xDD3A2D67,
    0xD1BDB096,    0xFBFDB74E,    0x2A8D184A,    0x76B50858,
    0x7CED9286,    0x911E4547,    0xA708A626,    0x514A5366,
    0x1C46C750,    0x386C3A62,    0x9CBA8ABA,    0x9A5E2776,
    0x1B596CBF,    0xF70870EB,    0x1C7FA042,    0xEC0CB6E1,
    0xA9CD735E,    0xAE4909EF,    0x604F3E75,    0x1DAB220C,
    0x8271677C,    0x5ECE344A,    0x9DCEFA22,     0xFE9C0EC,
    0x444645C6,    0xFD9384B6,    0x50E0893B,    0xFE5274A4,
    0x3D924558,    0xC67B415F,    0x8C377FE3,    0xD963F90C,
    0xBBF32F44,     0x961B1EB,    0xCCDCAA04,    0x849B3942,
    0xDD6C2AA9,    0xF6AB6E96,    0xC84D5DD6,    0x330B13BC,
    0x61728943,    0x77D83636,    0x3AFF41FA,    0xB464B2D9,
    0x7783A0F6,    0xF51236D2,    0x387AA580,    0xC50A5DEC,
    0xDAF8F65,    0x33B7DFB1,    0xFE5DD07C,    0x5D1F45D3,
    0xA3AD15FA,    0x1275B46A,    0x457ACF97,    0x7F995180,
    0x19EB6080,    0xEC4E1D6F,    0x875CC31D,     0xDCF788D,
    0x7E19DA27,    0x5EAF2EA6,    0x5C5FB60A,    0x1389094D,
    0xE3BC7F1D,    0x168003F2,    0xC2B76522,    0x19907B58,
    0xA9C3251D,    0x2CAF8747,    0x718C96F8,    0x753EC39E,
    0x508DD3FA,    0xE7C548B3,    0x25FDE507,    0x988D1EF7,
    0x49028E35,    0x1876C8FA,    0xF63B94B6,    0xE0ACE3B4,
    0x441BA909,    0xDCACCA9E,    0x2611D979,    0x680AD528,
    0x85FB147B,    0x7C1B236C,    0xE8F735CD,    0x55637040,
    0xAB772F6E,    0xB2D20913,    0x41A8B95C,    0x29593A13,
    0x8AAC97AE,    0x7D486631,    0xC425E3FA,    0x93FE946B,
    0xF40A7984,    0x6EEDA6E4,    0x754FE2C5,    0x3EE5895B,
    0x8BE45E42,    0x7DBB885A,     0xC756E2C,    0x21B31F4E,
    0x12887ED7,    0xD5456CDD,    0x47641481,    0x50AC2595,
    0x3A4790DE,    0xA6C7A468,    0x42F30788,    0x49C803F9,
    0xF8051AAB,    0xF437C5B6,    0xBE99F18C,    0x4ABE104A,
    0xD1CCBD5F,    0xE652F652,    0x74FAC467,    0x9999D7EF,
    0x26DD8CF3,    0x9AB142A3,    0x66F6851A,    0xDC427377,
    0xD40D552,    0xEED5E281,    0xAE3C2256,    0xE494D6A7,
    0x974CF75B,    0xD93B96C4,    0xCE563C91,    0xFDEE9D8D,
    0xAC41AEFB,    0xB3626D54,    0x823DFC94,    0xC03EDF8D,
    0x4FD6E4BD,    0x8AE91AB4,    0x8A66640C,    0xE313FEF2,
    0xF5450254,    0x6E17C09B,    0x85551817,    0x872D76FE,
    0x555D3DAE,    0xC66AC87E,    0xB22BB358,    0x8A10AB7D,
    0x32926C86,    0x9BACAA1F,    0xD0B39986,    0x570D404F,
    0x32105273,    0x6DFE42A1,    0xE2F942F9,    0xB3DADDFC,
    0x2DC46FF2,    0xFD6C1E18,     0x4568BBF,    0x129D0946,
    0x76765583,    0x23794C93,    0x39FD0C27,    0x62FCF1B1,
    0xB7CCF02C,    0x99B42FB4,    0x3F145D52,    0x5E31409E,
    0xB4E8DF0E,    0xCE44CBBB,    0x5A36F149,    0xDE1367D0,
    0x266E3B79,    0xB7779817,    0xA7936184,    0x26AE7686,
    0x8295EB74,    0x9AD94FF4,    0xED75B8FF,    0xB5CE6503,
    0x5140F956,    0xE43C39D4,    0x68544C4C,    0x9712E4A2,
    0xF9FED94D,    0x76CB0591,    0x9FE2089D,    0x36F53365,
    0x162EBE73,    0x731C92F7,    0x2F253A58,    0x256BE588,
    0xBC7A6CDF,    0x95BCC1D3,    0x1EF86C28,    0x7561BE0A,
    0x55F880B3,    0x78C5487F,    0x2C2BA909,     0x4DC7843,
    0xE932CA2B,    0x6EE67D74,    0x9E86D65A,    0xCAFE98F3,
    0xF3B396AD,    0xCBFAA75C,    0x15DF7B71,    0xAF1EBE52,
    0xAA22805F,    0x3C95529F,    0x572D1BA3,    0x534F759D,
    0x5946402F,     0xC929CF4,    0xA58FF75B,    0x6579FF29,
    0xA89D7DE3,    0x7E290374,    0x85E471A5,    0x6FE62EF2,
    0xF16D1DB5,    0x9AF638A3,    0x195BC8C3,    0x27CF272E,
    0x12CA1551,    0xF8167187,    0x68F8F6B7,    0x41EFBF56,
    0x31B6B4F4,    0x1BA6B236,    0x33B6FAD8,    0xBB9343BD,
    0x1AA2FDF5,    0xB164A6E1,    0x42072B62,    0x3228CA1C,
    0x8887EED5,    0x7633E4ED,    0xB76B0381,    0x2D4C0724,
    0x7773D3D0,    0xF4314DFC,    0x5C037366,    0xEE60150E,
    0x739799F1,    0xDBC2CC81,    0xF0963655,    0xC995CAA7,
    0xE5DD979B,    0x51AA364B,     0x1B19836,    0x677D8767,
    0x6CF2661B,    0xBB100C9B,    0x2D294FA1,    0x231D867C,
    0xA1D92ABB,    0x991755B0,     0x1AF45F6,    0xCFF9ADDA,
    0xF3F8E852,    0xC96A6959,    0x3E676CE5,     0xFA85BCF,
    0xEFAE55D0,    0x644EC104,    0x2F6B8B83,    0x9E61B98D,
    0x905C1D51,    0x81314D4D,    0x78E890D6,    0xA88D0C3F,
    0x147BC12C,    0x8E3C3812,    0xE3A75EEA,    0x13D58016,
    0xC9276082,    0x9DDD467C,    0x369C21DC,    0x4EB77EDD,
    0xDC3102D2,    0xB6E19999,    0xFAFA97EF,    0xAA8D7984,
    0x2C337106,    0x21798662,    0x55C1E815,    0x2125BE34,
    0x1697867E,    0xBE52E6D0,    0xD2CFF107,    0x2A4FC359,
    0x4831F7AD,    0x51A164EC,    0x376E17CF,    0x886CFABB,
    0x9246A89D,    0xCFB6C95E,    0x4F66105E,    0x1BFB1F87,
    0x34A37C83,    0xB50958FB,    0x418ABC92,    0xAD318563,
    0x2AABA351,    0x53CA0FDD,    0x594F7451,    0xC7816FF9,
    0x7E46C42,    0x1C760268,    0xDD525213,    0xFE31D60F,
    0xB70A16ED,    0x79DFA4E0,    0xDBF288F3,    0x42E6BF0D,
    0x5D1E9A58,    0x16C3A17B,    0x7A58AFC0,    0xAD3A0995,
    0x1877047E,    0xB459A06A,    0x470B180C,    0xDB453B92,
    0xD8D13A6A,    0xF8DF9E71,    0x887F953B,    0xB131DA42,
    0xAFDC543F,    0xBC2F3972,     0xDA7D395,    0x304AB34E,
    0x1DCF66CE,    0xDCCB02FD,    0xFC02A4D5,    0x440C2FD3,
    0xE3F7D223,     0xD6F4A65,    0x272A503D,    0x19351EF9,
    0x53C39A92,    0xA01EF8C7,    0x536B649A,    0x63D50D7D,
    0x20DAAECD,    0xE338D423,    0x904A0566,    0xB65E9242,
    0x2928BA74,    0x64025766,    0x869CBDC6,    0xD12F9F65,
    0x526B7B9B,    0x45BE7C7F,    0xC713CF27,    0x6E2CCEC8,
    0xCD4B0BE7,     0xDB512E9,    0x9B4C01C7,    0x944A3527,
    0xED63B017,    0xF64A8842,    0xD262EFCA,    0xE79DB2A2,
    0x76D3B314,    0x438AC2D3,    0x1601DFC4,    0x77ED41D2,
    0x6AD02904,     0x6B965A8,    0x366C0B4F,     0xF444558,
    0x5BB6C355,    0x7567279A,    0xFE18F095,    0x87F65BE9,
    0x4094A556,    0xBFFAA261,    0x8035A767,    0x9443AC66,
    0x3A41AC3B,    0x54C622A7,    0x6543AD47,    0x1754BCE4,
    0xEFE5C738,    0xB814F391,    0xBF1A33F9,    0x6B5637BF,
    0x5312C289,    0xD436B858,    0x5B05F419,    0xBB08C42C,
    0x7A4D9887,    0xC61B32D0,     0x9497FA0,    0x4D49D647,
    0x6A1F40B6,    0xB0D815FF,    0x74B98980,    0x512AF7A1,
    0xE7A70255,    0x873D58AA,    0x72453EAA,    0xB5FD1E57,
    0xC7AD426E,    0x64630664,    0xCC0B91A5,    0xF3667A18,
    0x42A9D4E6,    0xD63C871F,    0x97E40A9A,    0x646948BC,
    0x3B5BC910,    0xB1A27BBE,    0xFFFA9765,     0x8FB1AD3,
    0x1857C237,    0x5AE98123,    0x19525EA6,    0x5D94AF37,
    0x1117BCB0,    0x9D728CBD,    0xB05E89CF,    0xB0BC4413,
    0x7C0AE4F1,    0x78B1319E,    0x9A0E9B39,    0x691ED7FC,
    0x22256596,    0x7046F304,     0x45EBAAA,    0x5B920B03,
    0x7703679,    0x5B8C1F6C,    0x43E88571,    0x15B5E4B7,
    0xC21C6F3E,    0xB7A48D26,    0xA4F5616D,    0x3476A6C7,
    0xCF0C16E2,    0xF38CFDDD,    0xBE0B4621,    0xAFA19E84,
    0xD3E96CD4,    0x45A75D2F,    0xBFF79644,    0x2D78F177,
    0xF63347F8,    0xF4559F36,    0xBC6DE84F,    0xCDBAF272,
    0xB34CD340,    0x2E7D881D,    0x8609D910,    0x7D3C6B1D,
    0x200F71B8,    0x54207DAD,    0x71E15EB5,    0xC7EE7108,
    0xC6D7FB18,    0xCAE7D7E1,    0x2FA08EE5,    0x9FF73639
]

C = ""
with open(sys.argv[1], "rb") as f:
    C = f.read()

off = 0
def unpack(fmt: str, data: bytes, size: int):
    global off
    out = struct.unpack(fmt, data[off:off+size])
    off += size
    if len(out) == 1:
        return out[0]
    return out

n_catalogs = unpack("=Q", C, 8) & 0xFFFFFFFF

def decrypt1(word, key) -> int:
    key = key & 0xff  # byte
    out = word >> (key & 0x1f) | word << 0x20 - (key & 0x1f)
    return out & 0xffffffff  # word

def decrypt2(word, key) -> int:
    word = word & 0xffffffff
    return word ^ XOR_MASK[key % 2048]

print("blob1 size:", n_catalogs*268)

decrypted_blob1 = bytes()
for key in range(n_catalogs * 268 // 4):
    x = unpack("=I", C, 4)
    x1 = decrypt1(x, key)
    x2 = decrypt2(x1, key)
    u = struct.pack("=I", x2)
    decrypted_blob1 += u

@dataclass
class MangDataCatalog:
    file_name: any
    key1: int
    key2: int
    offset: int
    uncompressed_size: int
    size: int

    def __post_init__(self):
        self.file_name = self.file_name.split(b"\x00")[0].decode("utf-8")

catalogs = []
for i in range(n_catalogs):
    unpacked = struct.unpack("=253s B H I I I", decrypted_blob1[i*268:(i+1)*268])
    catalog = MangDataCatalog(*unpacked)
    catalogs.append(catalog)

# https://stackoverflow.com/a/37400585
def decompress_lzma(data):
    results = []
    while True:
        decomp = lzma.LZMADecompressor(lzma.FORMAT_AUTO, None, None)
        try:
            res = decomp.decompress(data)
        except lzma.LZMAError:
            if results:
                break  # Leftover data is not a valid LZMA/XZ stream; ignore it.
            else:
                raise  # Error on the first iteration; bail out.
        results.append(res)
        data = decomp.unused_data
        if not data:
            break
        if not decomp.eof:
            raise lzma.LZMAError("Compressed data ended before the end-of-stream marker was reached")
    return b"".join(results)

for catalog in catalogs:
    blob = C[catalog.offset:catalog.offset+catalog.size]
    decrypted = bytes()
    for i in range(catalog.size // 4):
        x = struct.unpack("=I", blob[i*4:(i+1)*4])[0]
        x1 = decrypt1(x, catalog.key1 + i)
        x2 = decrypt2(x1, catalog.key2 + i)
        u = struct.pack("=I", x2)
        decrypted += u
    decompressed = decompress_lzma(decrypted[1:])
    raw_path = catalog.file_name.replace("..\\", "")
    split_path = raw_path.split("\\")
    os.makedirs(os.path.join(*split_path[:-1]), exist_ok=True)
    file_path = os.path.join(*split_path)
    print("extracting", file_path)
    with open(file_path, "wb") as f:
        f.write(decompressed)
